---
title: "ç£ç›˜å­˜å‚¨ä¸æ–‡ä»¶ç³»ç»Ÿç®¡ç†"
date: 2025-06-17
slug: "disk-storage-filesystem"
categories: ["æ“ä½œç³»ç»Ÿ", "Linux"]
tags: ["ç£ç›˜ç®¡ç†", "åˆ†åŒº", "æ–‡ä»¶ç³»ç»Ÿ", "RAID", "LVM", "å­˜å‚¨ç®¡ç†"]
draft: false
description: "æœ¬èŠ‚ç³»ç»Ÿè®²è§£ Linux ä¸­çš„ç£ç›˜ç»“æ„ã€åˆ†åŒºç±»å‹ã€æ–‡ä»¶ç³»ç»Ÿç®¡ç†å‘½ä»¤ï¼Œç»“åˆ RAID ä¸ LVM çš„æ¦‚å¿µã€å·¥å…·ä¸åº”ç”¨åœºæ™¯ï¼Œå¸®åŠ©å»ºç«‹å®Œæ•´çš„å­˜å‚¨ç³»ç»Ÿç†è§£ã€‚"
---

### ä¸€ã€ç£ç›˜ç»“æ„ä¸åŸºç¡€æœ¯è¯­

åœ¨ Linux ä¸­ï¼Œæ‰€æœ‰è®¾å¤‡ï¼ˆåŒ…æ‹¬ç¡¬ç›˜ï¼‰éƒ½è¢«è§†ä¸ºæ–‡ä»¶ï¼Œç§°ä¸ºâ€œ**è®¾å¤‡æ–‡ä»¶**â€ã€‚

#### 1. è®¾å¤‡æ–‡ä»¶

- ä½äº `/dev` ç›®å½•ä¸­ï¼›
- å‘½åè§„åˆ™ï¼š
  - `/dev/sda`ï¼šç¬¬ä¸€ä¸ªSCSI/SATAç£ç›˜
  - `/dev/sdb1`ï¼šç¬¬äºŒå—ç£ç›˜çš„ç¬¬ä¸€ä¸ªåˆ†åŒº
<!--more-->

#### 2. å¸¸è§æœ¯è¯­è§£é‡Š

| åç§° | å«ä¹‰ |
|------|------|
| å—è®¾å¤‡ï¼ˆBlock deviceï¼‰ | æ”¯æŒéšæœºè®¿é—®çš„å­˜å‚¨è®¾å¤‡ï¼Œå¦‚ç¡¬ç›˜ã€Uç›˜ |
| åˆ†åŒºï¼ˆPartitionï¼‰ | å°†ä¸€ä¸ªç£ç›˜åˆ’åˆ†ä¸ºè‹¥å¹²é€»è¾‘åŒºåŸŸ |
| æ–‡ä»¶ç³»ç»Ÿï¼ˆFilesystemï¼‰ | ç”¨äºç»„ç»‡å’Œç®¡ç†æ–‡ä»¶æ•°æ®çš„ç»“æ„ |
| æŒ‚è½½ï¼ˆMountï¼‰ | å°†è®¾å¤‡æˆ–ç›®å½•æ¥å…¥ä¸»æ–‡ä»¶ç³»ç»Ÿç›®å½•æ ‘ |
| æŒ‚è½½ç‚¹ï¼ˆMount pointï¼‰ | ç”¨äºè®¿é—®æŒ‚è½½è®¾å¤‡çš„ç›®å½• |

---

### äºŒã€åˆ†åŒºç±»å‹ä¸åˆ†åŒºè¡¨ç»“æ„

#### 1. åˆ†åŒºè¡¨ç±»å‹å¯¹æ¯”ï¼šMBR vs GPT

| é¡¹ç›®     | MBR                        | GPT                          |
|----------|----------------------------|-------------------------------|
| æœ€å¤§å®¹é‡ | 2TB                        | ç†è®ºä¸Šæ— é™ï¼ˆç›®å‰ä¸º 9.4ZBï¼‰    |
| åˆ†åŒºæ•°   | æœ€å¤š 4 ä¸ªä¸»åˆ†åŒº            | 128 ä¸ªä»¥ä¸Š                   |
| å…¼å®¹æ€§   | ä¸æ—§ BIOS å…¼å®¹             | éœ€ UEFI å¯åŠ¨æ”¯æŒ              |
| ç»“æ„     | ä¸»å¼•å¯¼è®°å½• + åˆ†åŒºè¡¨        | ä¸» GUID è¡¨ + å¤‡ä»½åˆ†åŒºè¡¨       |
| å®‰å…¨æ€§   | æ— å†—ä½™                     | æœ‰åˆ†åŒºè¡¨å¤‡ä»½ï¼Œé˜²ç ´å         |

#### 2. ç®¡ç†åˆ†åŒºå·¥å…·

```bash
fdisk /dev/sdX       # é’ˆå¯¹ MBR åˆ†åŒº
parted /dev/sdX      # æ”¯æŒ GPT å’Œ MBR
lsblk                # æŸ¥çœ‹å—è®¾å¤‡ç»“æ„
blkid                # æŸ¥çœ‹è®¾å¤‡ UUID ä¸ç±»å‹
```

---

### ä¸‰ã€æ–‡ä»¶ç³»ç»ŸåŸºç¡€ä¸ç®¡ç†

#### 1. å¸¸è§æ–‡ä»¶ç³»ç»Ÿç±»å‹

| ç±»å‹   | ç‰¹ç‚¹                         |
|--------|------------------------------|
| ext4   | é»˜è®¤æ–‡ä»¶ç³»ç»Ÿï¼Œç¨³å®šå¯é        |
| xfs    | å¤§æ–‡ä»¶æ”¯æŒå¥½ï¼Œå†™å…¥æ€§èƒ½ä½³     |
| btrfs  | æ”¯æŒå¿«ç…§ã€è‡ªä¿®å¤ã€é«˜å¯ç”¨æ€§   |
| vfat   | è·¨å¹³å°å…¼å®¹æ€§é«˜               |

#### 2. æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºä¸ç®¡ç†å‘½ä»¤

```bash
mkfs.ext4 /dev/sda1     # åˆ›å»º ext4 æ–‡ä»¶ç³»ç»Ÿ
mkfs.xfs /dev/sdb1      # åˆ›å»º xfs
fsck /dev/sda1          # æ£€æŸ¥å¹¶ä¿®å¤æ–‡ä»¶ç³»ç»Ÿ
tune2fs -l /dev/sda1    # æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯
```

---

### å››ã€æŒ‚è½½ä¸æŒ‚è½½ç®¡ç†

#### 1. æŒ‚è½½æ“ä½œ

```bash
mount /dev/sda1 /mnt         # æ‰‹åŠ¨æŒ‚è½½
umount /mnt                  # å¸è½½
```

#### 2. æŸ¥çœ‹æŒ‚è½½çŠ¶æ€

```bash
mount        # æ˜¾ç¤ºæ‰€æœ‰æŒ‚è½½é¡¹
df -h        # æŸ¥çœ‹ç£ç›˜ç©ºé—´ä¸æŒ‚è½½ç‚¹
findmnt      # å±‚çº§ç»“æ„æŸ¥çœ‹æŒ‚è½½
```

#### 3. æ°¸ä¹…æŒ‚è½½

ç¼–è¾‘ `/etc/fstab` æ–‡ä»¶ï¼Œæ·»åŠ ä¸€è¡Œï¼š

```bash
UUID=xxxxx  /mnt/data  ext4  defaults  0  2
```

è·å– UUIDï¼š

```bash
blkid /dev/sda1
```

#### 4. äº¤æ¢åˆ†åŒºæ“ä½œ

```bash
mkswap /dev/sdX
swapon /dev/sdX
swapoff /dev/sdX
```

#### 5. å¯ç§»åŠ¨è®¾å¤‡ç®¡ç†

- é€šå¸¸ç”±ç³»ç»Ÿè‡ªåŠ¨æŒ‚è½½åˆ° `/media/ç”¨æˆ·å/`
- ä½¿ç”¨ `udisksctl` æˆ– `mount` å¯æ‰‹åŠ¨æŒ‚è½½

---

### äº”ã€ç£ç›˜é…é¢ç®¡ç†ï¼ˆQuotaï¼‰

ç”¨äºé™åˆ¶ç”¨æˆ·/ç»„ä½¿ç”¨ç£ç›˜èµ„æºï¼š

```bash
quota username              # æŸ¥çœ‹ç”¨æˆ·é…é¢
edquota username            # ç¼–è¾‘é…é¢
repquota -a                 # æŸ¥çœ‹æ‰€æœ‰é…é¢ç»Ÿè®¡
```

å¯ç”¨æ­¥éª¤ï¼š
1. ä¿®æ”¹æŒ‚è½½é€‰é¡¹æ”¯æŒ `usrquota` æˆ– `grpquota`ï¼›
2. é‡æ–°æŒ‚è½½åˆ†åŒºï¼›
3. åˆå§‹åŒ–é…é¢æ•°æ®åº“ `quotacheck -cum /mnt`;
4. å¯ç”¨é…é¢ `quotaon /mnt`

---

### å…­ã€RAID æŠ€æœ¯æ¦‚è§ˆ

RAIDï¼ˆRedundant Array of Independent Disksï¼‰ï¼šå†—ä½™ç£ç›˜é˜µåˆ—ï¼Œç”¨äºæé«˜æ€§èƒ½ä¸å¯é æ€§ã€‚

#### å„çº§åˆ«å¯¹æ¯”

| RAIDçº§åˆ« | æœ€å°‘ç£ç›˜æ•° | åˆ©ç”¨ç‡     | å†—ä½™æ€§   | æ€§èƒ½           | ç‰¹ç‚¹                        |
|----------|------------|------------|----------|----------------|-----------------------------|
| RAID 0   | 2          | 100%       | æ—        | è¯»å†™æœ€å¿«       | æ¡å¸¦åŒ–ï¼Œæ— å†—ä½™ï¼Œæ€§èƒ½ä¼˜å…ˆ     |
| RAID 1   | 2          | 50%        | é«˜       | è¯»å–å¿«ï¼Œå†™å…¥ç•¥æ…¢ | é•œåƒï¼Œæ•°æ®å®Œå…¨å¤åˆ¶            |
| RAID 5   | 3          | (n-1)/n    | å¯å®¹å¿1å— | è¯»å–å¿«ï¼Œå†™å…¥ä¸­ç­‰ | æ¡å¸¦åŒ–+å¥‡å¶æ ¡éªŒ               |
| RAID 10  | 4          | 50%        | é«˜       | é«˜è¯»å†™æ€§èƒ½      | RAID 1+0ï¼Œé•œåƒåå†æ¡å¸¦åŒ–      |
| RAID 01  | 4          | 50%        | ä¸­       | è¾ƒå¿«           | RAID 0+1ï¼Œæ¡å¸¦åŒ–åå†é•œåƒ      |

- ğŸ’¡ RAID 10 ä¼˜äº RAID 01ï¼Œåœ¨æ•…éšœå®¹å¿æ–¹é¢æ›´ç¨³å®šã€‚RAID ä¸ç­‰äºå¤‡ä»½ï¼Œä»å»ºè®®å®šæœŸå¤‡ä»½æ•°æ®ã€‚

---

### ä¸ƒã€LVMï¼ˆé€»è¾‘å·ç®¡ç†ï¼‰

LVMï¼ˆLogical Volume Managerï¼‰ä¸º Linux æä¾›çµæ´»çš„ç£ç›˜ç®¡ç†æ–¹å¼ï¼Œæ”¯æŒåŠ¨æ€æ‰©å®¹ã€å¿«ç…§ç­‰ã€‚

#### åŸºæœ¬ç»“æ„

```text
ç‰©ç†å·ï¼ˆPVï¼‰ -> å·ç»„ï¼ˆVGï¼‰ -> é€»è¾‘å·ï¼ˆLVï¼‰
```

#### 1. åˆ›å»ºæµç¨‹

```bash
# åˆ›å»º PV
pvcreate /dev/sdb1

# åˆ›å»º VG
vgcreate myvg /dev/sdb1

# åˆ›å»º LV
lvcreate -L 10G -n mylv myvg

# æ ¼å¼åŒ–å¹¶æŒ‚è½½
mkfs.ext4 /dev/myvg/mylv
mount /dev/myvg/mylv /mnt
```

#### 2. æ‰©å®¹ä¸ç¼©å‡

```bash
lvextend -L +5G /dev/myvg/mylv     # æ‰©å®¹
resize2fs /dev/myvg/mylv           # åŒæ­¥æ–‡ä»¶ç³»ç»Ÿ

lvreduce -L 5G /dev/myvg/mylv      # ç¼©å‡ï¼ˆéœ€å…ˆ umountï¼‰
```

- âš ï¸ ç¼©å‡å·å­˜åœ¨æ•°æ®ä¸¢å¤±é£é™©ï¼Œå»ºè®®å¤‡ä»½æ•°æ®å¹¶ç¡®ä¿æŒ‚è½½å·²å¸è½½ã€‚

#### 3. å¿«ç…§å·ï¼ˆsnapshotï¼‰

```bash
lvcreate -s -L 1G -n snap /dev/myvg/mylv
```

- å¿«ç…§é€šå¸¸ç”¨äºå¤‡ä»½æˆ–çŸ­æœŸå®éªŒï¼›
- æ¢å¤å¿«ç…§å‰éœ€å¸è½½åŸå·ã€‚

---

### å…«ã€ä½¿ç”¨åœºæ™¯å»ºè®®

| åœºæ™¯ | æ¨èæ–¹å¼ |
|------|-----------|
| å•ç”¨æˆ·ç³»ç»Ÿï¼Œç®€å•æŒ‚è½½ | ext4 + æ‰‹åŠ¨åˆ†åŒº |
| å¤šç”¨æˆ·æˆ–åŠ¨æ€æ‰©å±• | LVM + ext4/xfs |
| é«˜å¯ç”¨æœåŠ¡å™¨ | RAID 1 / 5 / 10 + LVM |
| å¿«é€Ÿå¤‡ä»½ | LVM å¿«ç…§ + `rsync` |
| ç§»åŠ¨è®¾å¤‡å…¼å®¹æ€§ | ä½¿ç”¨ `vfat` æˆ– `exfat` æ–‡ä»¶ç³»ç»Ÿ |

---

